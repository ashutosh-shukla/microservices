<%@ page contentType="text/html;charset=UTF-8" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<!DOCTYPE html>
<html>
<head>
    <title>Customer Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <div class="row">
        <div class="col-md-12">
            <h2>Customer Dashboard</h2>
            
            <!-- Error Messages -->
            <c:if test="${not empty error}">
                <div class="alert alert-danger">${error}</div>
            </c:if>
            
            <!-- Success Messages -->
            <c:if test="${not empty successMessage}">
                <div class="alert alert-success">${successMessage}</div>
            </c:if>
            
            <!-- Warning Messages -->
            <c:if test="${not empty warningMessage}">
                <div class="alert alert-warning">${warningMessage}</div>
            </c:if>
            
            <!-- Customer Details -->
            <c:if test="${not empty customer}">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5>Customer Information</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Name:</strong> ${customer.firstName} ${customer.lastName}</p>
                        <p><strong>Email:</strong> ${customer.email}</p>
                        <p><strong>Phone:</strong> ${customer.phoneNumber}</p>
                        <p><strong>Status:</strong> 
                            <span class="badge ${customer.status == 'ACTIVE' ? 'bg-success' : 'bg-warning'}">
                                ${customer.status}
                            </span>
                        </p>
                    </div>
                </div>
            </c:if>
            
            <!-- Account Details -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5>Account Information</h5>
                </div>
                <div class="card-body">
                    <c:choose>
                        <c:when test="${hasAccount == true and not empty account}">
                            <p><strong>Account Number:</strong> ${account.accountNumber}</p>
                            <p><strong>Account Type:</strong> ${account.accountType}</p>
                            <p><strong>Balance:</strong> â‚¹${account.balance}</p>
                            <p><strong>Status:</strong> 
                                <span class="badge bg-success">${account.status}</span>
                            </p>
                        </c:when>
                        <c:otherwise>
                            <div class="alert alert-warning">
                                <i class="fas fa-exclamation-triangle"></i>
                                ${not empty accountMessage ? accountMessage : 'No account present. KYC verification pending.'}
                            </div>
                            <a href="/customer/kyc/${customer.customerId}" class="btn btn-primary">
                                Complete KYC Verification
                            </a>
                        </c:otherwise>
                    </c:choose>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="card">
                <div class="card-header">
                    <h5>Quick Actions</h5>
                </div>
                <div class="card-body">
                    <c:if test="${hasAccount == true}">
                        <a href="/customer/transactions/${customer.customerId}" class="btn btn-info me-2">
                            View Transactions
                        </a>
                        <a href="/customer/transfer/${customer.customerId}" class="btn btn-success me-2">
                            Transfer Money
                        </a>
                    </c:if>
                    <a href="/customer/profile/${customer.customerId}" class="btn btn-secondary me-2">
                        Update Profile
                    </a>
                    <c:if test="${hasAccount != true}">
                        <a href="/customer/kyc/${customer.customerId}" class="btn btn-warning">
                            Complete KYC
                        </a>
                    </c:if>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>